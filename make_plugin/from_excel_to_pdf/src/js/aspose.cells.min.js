function writeXlsx(event, resp) {
    return new kintone.Promise(async function (resolve, reject) {
        try {
            const record = event.record;

            // ExcelJSで編集したExcelを取得
            const workbook = new ExcelJS.Workbook();
            await workbook.xlsx.load(resp);

            // 作業用ファイルをバイナリ形式で保存
            const excelBuffer = await workbook.xlsx.writeBuffer();

            // Aspose.Cellsの初期化
            const aspose = await Aspose.Cells.load();
            const workbookAspose = new aspose.Workbook();

            // Aspose.CellsにExcelデータをロード
            workbookAspose.open(excelBuffer);

            // PDFに変換
            const pdfBuffer = workbookAspose.saveToPdfBuffer();

            // PDFをダウンロード
            const blob = new Blob([pdfBuffer], { type: 'application/pdf' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'invoice.pdf';
            link.click();

            resolve(); // 完了
        } catch (error) {
            console.error("エラーが発生しました: ", error);
            reject(error);
        }
    });
}
